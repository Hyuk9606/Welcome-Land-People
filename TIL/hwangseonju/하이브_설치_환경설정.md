# í•˜ì´ë¸Œ ì„¤ì¹˜ ë° í™˜ê²½ì„¤ì •

<br>

### [ í•˜ì´ë¸Œ ì„¤ì¹˜ ]

- ë²„ì „ : 3.1.2

1. ì‚¬ìš©í•  ë²„ì „ì— ë§ì¶°ì„œ Hive ë‹¤ìš´ë¡œë“œ ë°›ê¸°
   
    ```bash
    $ wget https://downloads.apache.org/hive/hive-3.1.2/apache-hive-3.1.2-bin.tar.gz
    ```
    
2. ë‹¤ìš´ë°›ì€ íŒŒì¼ ì••ì¶• í•´ì œí•˜ê¸°
   
    ```bash
    $ tar xzf apache-hive-3.1.2-bin.tar.gz
    ```
    
    ![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled.png)
    

<br>

### [ í•˜ì´ë¸Œ í™˜ê²½ì„¤ì • ]

1. í™˜ê²½ë³€ìˆ˜ ì¶”ê°€í•˜ê¸°
    - export HIVE_HOME=â€/home/hadoop/apache-hive-3.1.2-binâ€
    - export PATH=â€$PATH:$HIVE_HOME/binâ€
    
    (ìœ„ì˜ ë‚´ìš©ì„ ë³µì‚¬í•˜ê²Œë˜ë©´ ë”°ì˜´í‘œê°€ ì˜ ì¸ì‹ë˜ì§€ì•Šì•„ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ëŠ” ê²½ìš° ìˆìœ¼ë¯€ë¡œ ìƒ‰ìƒì˜ ë³€í™”ê°€ ìˆëŠ”ì§€ ì˜ í™•ì¸í•˜ì..! ê·¸ë¦¬ê³  pathì—ë„ ë”°ì˜´í‘œë¥¼ ë„£ì–´ì¤˜ì•¼ ë˜ëŠ”ê²ƒê°™ë‹¤. í˜¹ì‹œ ì˜¤ë¥˜ê°€ ë‚˜ë©´ ì´ê²ƒë„ í™•ì¸í•´ë³´ê¸¸)
    
    ```bash
    $ nano .bashrc
    ```
    
2. ë³€ê²½ì‚¬í•­ ì ìš©í•˜ê¸°
   
    ```bash
    $ source ~/.bashrc
    ```
    

<br>

### [ Hiveì™€ HDFS ìƒí˜¸ì‘ìš© ì„¤ì • ]

1. hive-config.sh íŒŒì¼ì— í™˜ê²½ë³€ìˆ˜ ì¶”ê°€í•˜ê¸°
    - export HADOOP_HOME=/home/hdoop/hadoop-3.2.1
    
    ```bash
    $ nano /apache-hive-3.1.2-bin/bin/hive-config.sh
    ```
    
    ![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%201.png)
    

<br>

### [ HDFSì— Hive ë””ë ‰í† ë¦¬ ìƒì„± ]

- ë°ì´í„°ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ ë¶„ë¦¬ëœ 2ê°œì˜ ë””ë ‰í† ë¦¬ ìƒì„±(tmp, warehouse)

1. í•˜ë‘¡ ì‹¤í–‰í•˜ê¸°
   
    ```bash
    $ start-dfs.sh
    ```
    
1. tmp ë””ë ‰í† ë¦¬ ìƒì„±í•˜ê¸°
    - Hive processì˜ ì¤‘ê°„ ë°ì´í„° ê²°ê³¼ ì €ì¥í•˜ëŠ” ê³³
    
    ```bash
    $ hdfs dfs -mkdir /tmp
    ```
    
2. tmp ë””ë ‰í† ë¦¬ì— ì“°ê¸° ë° ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬í•˜ê¸°
   
    ```bash
    $ hdfs dfs -chmod g+w /tmp
    ```
    
    (ê¶Œí•œ ë¶€ì—¬ ì „)
    
    ![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%202.png)
    
    (ê¶Œí•œ ë¶€ì—¬ í›„)
    
    ![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%203.png)
    
1. warehouse ë””ë ‰í† ë¦¬ ìƒì„±í•˜ê³  ì“°ê¸° ë° ì‹¤í–‰ ê¶Œí•œ ë¶€ì—¬í•˜ê¸°
    - Hiveì™€ ê´€ë ¨ëœ í…Œì´ë¸” ì €ì¥í•˜ëŠ” ê³³
    
    ```bash
    $ hdfs dfs -mkdir -p /user/hive/warehouse
    $ hdfs dfs -chmod g+w /user/hive/warehouse
    ```
    

<br>

### [ hive-site.xml íŒŒì¼ ì„¤ì • ]

1. conf ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•˜ê¸°
   
    ```bash
    $ cd home/hadoop/apache-hive-3.1.2-bin/conf
    (= cd $HIVE_HOME/conf)
    ```
    
    ![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%204.png)
    
2. hive-default.xml.template íŒŒì¼ì„ hive-site.xml ëª…ìœ¼ë¡œ ë³µì‚¬í•˜ê¸°
   
    ```bash
    $ cp hive-default.xml.template hive-site.xml
    ```
    
3. hive-site.xml ìˆ˜ì •í•˜ê¸°
    - property 2ê°œ ì¶”ê°€í•˜ê¸°
    
    ```bash
    <property>
        <name>system:java.io.tmpdir</name>
        <value>/tmp/hive/java</value>
    </property>
    <property>
        <name>system:user.name</name>
        <value>${user.name}</value>
    </property>
    ```
    
    ```bash
    $ nano hive-site.xml
    ```
    
    ![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%205.png)
    

- connectionurl ìˆ˜ì •í•˜ê¸°
- ctrl+wë¡œ javax.jdo.option.ConnectionURL ê²€ìƒ‰í•´ì„œ ì°¾ê¸°

```bash
jdbc:derby:/home/hdoop/apache-hive-3.1.2-bin/metastore_db;databaseName=metastore_db;create=true
```

![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%206.png)

<br>

### [ derby database ì‹œì‘ ]

1. derby database ì‹¤í–‰í•˜ê¸°
   
    ```bash
    $ $HIVE_HOME/bin/schematool -initSchema -dbType derby
    ```
    

(ì˜¤ë¥˜ë°œìƒ)

![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%207.png)

(ì‹œë„1 : ì˜¤ë¥˜ í•´ê²°X, ìƒìœ„ ë””ë ‰í† ë¦¬ê°€ ê°™ì•„ì•¼ë˜ëŠ”ê±´ ì•„ë‹Œê²ƒ ê°™ìŒ, ê·¸ë˜ë„ í•œ ë””ë ‰í† ë¦¬ ë‚´ì—ì„œ ê´€ë¦¬í•˜ê³  ì‹¶ìœ¼ë©´ ì˜®ê²¨ë„ ë‚˜ì˜ì§„ì•Šì„ë“¯)

- hadoopì´ ì„¤ì¹˜ëœ ìœ„ì¹˜ì™€ hive ì„¤ì¹˜ ìœ„ì¹˜ë¥¼ ë™ì¼í•˜ê²Œ ë³€ê²½ì‹œì¼œì¤Œ
- hadoop ì„¤ì¹˜ ìœ„ì¹˜ : /usr/local/hadoop
- hive ì„¤ì¹˜ ìœ„ì¹˜ : /usr/local/hive

```bash
$ sudo mv apache-hive-3.1.2-bin /usr/local/hive
```

(í•´ê²°ë°©ì•ˆ)

- .bashrcì— ì„¤ì •í•œ ê²½ë¡œë§Œ ì‹ ê²½ì¼ëŠ”ë° hive-config.shì— ìˆëŠ” hadoop ê²½ë¡œê°€ ì˜ëª» ì„¤ì •ë˜ì–´ ìˆì–´ì„œ ìˆ˜ì •í•˜ë‹ˆ ìš°ì„  ì‹¤í–‰ì€ ëìŒ

```bash
$ nano $HIVE_HOME/bin/hive-config.sh
```

![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%208.png)

1-2. 1ë²ˆ ì‹¤í–‰ì‹œì— ì•„ë˜ì™€ ê°™ì€ ì˜¤ë¥˜ê°€ ë°œìƒí•œë‹¤ë©´?

(ì˜¤ë¥˜ë°œìƒ)

![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%209.png)

(ì›ì¸)

- $HIVE_HOME/libì— ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ ì¤‘ì— guava versionëŠ” 19.0
- $HADOOP_HOME/share/hadoop/hdfs/libì— ìˆëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ ì¤‘ guava versionì€ 27.0

â†’ hadoopê³¼ hiveì˜ guava version í˜¸í™˜ì„± ë¬¸ì œë•Œë¬¸ì— ë°œìƒí•œ ì˜¤ë¥˜ì´ê¸° ë•Œë¬¸

(í•´ê²°ë°©ì•ˆ)

- Hiveì˜ guavaë¥¼ ì œê±°í•œ í›„ Hadoopì— ìˆëŠ” guavaë¥¼ ë³µì‚¬í•˜ê¸°

```bash
$ rm HIVE_HOME/lib/guava-19.0.jar
$ cp $HADOOP_HOME/share/hadoop/hdfs/lib/guava-27.0-jre.jar $HIVE_HOME/lib/
```

1-3. 1-2ë²ˆ ì˜¤ë¥˜ ìˆ˜ì •í›„ ì¬ì‹œì‘ì„ í•˜ë©´ ì•„ë˜ì™€ ê°™ì€ ë˜ ë‹¤ë¥¸ ì˜¤ë¥˜ ë°œìƒí•˜ë©´..?

(ì˜¤ë¥˜ ë°œìƒ)

![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%2010.png)

(í•´ê²°ë°©ì•ˆ)

- í•´ë‹¹ ìœ„ì¹˜ë¡œ ê°€ì„œ ì•„ë˜ì™€ ê°™ì´ ë³´ì´ëŠ” íŠ¹ìˆ˜ë¬¸ìë¥¼ ì œê±°
  
    (ìœ„ì¹˜ ì°¾ëŠ” ë‹¨ì¶•í‚¤ :  ctrl+shift+-(ë§ˆì´ë„ˆìŠ¤)
    
    ![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%2011.png)
    

1-3. ë“œë””ì–´ ì‹¤í–‰ë˜ë‚˜ ì‹¶ì—ˆì§€ë§Œ ì˜¤ë¥˜ê°€ ë‚¬ë‹¤

(ì˜¤ë¥˜ ë°œìƒ)

- ì´ˆë°˜ì— hive ìœ„ì¹˜ë¥¼ ë°”ê¾¸ê¸°ì „ì— ì„¤ì •í•´ë‘” ê²½ë¡œë“¤ì—ì„œ ì˜¤ë¥˜ê°€ ë‚œ ë“¯ í•˜ë‹¤...^^

![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%2012.png)

(í•´ê²° ë°©ì•ˆ)

- hive, hadoop ê²½ë¡œë¥¼ ì„¤ì •í–ˆë˜ ëª¨ë“  ë¶€ë¶„ì„ ìˆ˜ì •í•œë‹¤.

1. ë“œë””ì–´ ì‹¤í–‰ ì„±ê³µ!!!!

![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%2013.png)

<br>

### [ Hive Client Shell ì‹œì‘ ]

1. hive ë°‘ì— bin ë””ë ‰í† ë¦¬ë¡œ ì´ë™í•˜ê¸°
   
    ```bash
    $ cd $HIVE_HOME/bin
    ```
    
2. ì‹¤í–‰í•˜ê¸°
   
    ```bash
    $ hive
    ```
    
    ![Untitled](./img/í•˜ì´ë¸Œ_ì„¤ì¹˜_í™˜ê²½ì„¤ì •/Untitled%2014.png)
    

<br>

<br>

ğŸ“š **References**

 â­ [https://spidyweb.tistory.com/215](https://spidyweb.tistory.com/215)

- [https://m.blog.naver.com/PostView.nhn?isHttpsRedirect=true&blogId=bea66gle&logNo=220819145604](https://m.blog.naver.com/PostView.nhn?isHttpsRedirect=true&blogId=bea66gle&logNo=220819145604)
- [https://velog.io/@jodawooooon/BigData-UbuntuEC2ì—-Hive-3.1.2ë¥¼-ì„¤ì¹˜í•´ë³´ì](https://velog.io/@jodawooooon/BigData-UbuntuEC2%EC%97%90-Hive-3.1.2%EB%A5%BC-%EC%84%A4%EC%B9%98%ED%95%B4%EB%B3%B4%EC%9E%90)